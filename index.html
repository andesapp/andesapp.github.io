<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Andes</title>
  <link rel="shortcut icon" href="#">
  <script type="text/javascript">
    // Set the Pyodide files URL (packages.json, pyodide.asm.data etc).
    window.languagePluginUrl = '/pyodide/';
  </script>
  <script src="/pyodide/pyodide.js"></script>
  <script src="/pyodide/cases.asm.data.js"></script>
  <script src="/pyodide/andes.asm.data.js"></script>
</head>
<body>
Andes test page <br>
Open your browser console to see output
<script type="text/javascript">
  languagePluginLoader.then(function () {
    console.log(pyodide.runPython(`
                  import sys
                  sys.version
              `));
    // console.log(pyodide.runPython(`
    //               from os import listdir
    //               print(listdir('/home/web_user/.andes/pycode'))
    //           `));

//     pyodide.loadPackage('scipy').then(() => {
//       console.log(pyodide.runPython(`
// import scipy.stats as sps
// sps.linregress([0, 1, 2, 3], [3, 3, 2, 5])
//               `));

    pyodide.loadPackage(['numpy', 'sympy', 'mpmath', 'kvxopt', 'dill', 'tqdm', 'andes']).then(() => {
      console.log(pyodide.runPython(`
#from kvxopt import matrix, spmatrix, sparse, spdiag
#from kvxopt.amd import order
#from kvxopt.umfpack import linsolve
#from kvxopt import umfpack
#from kvxopt import klu
#from kvxopt import mul, div
#from kvxopt.lapack import gesv

#V = [2, 3, 3, -1, 4, 4, -3, 1, 2, 2, 6, 1]
#I = [0, 1, 0,  2, 4, 1,  2, 3, 4, 2, 1, 4]
#J = [0, 0, 1,  1, 1, 2,  2, 2, 2, 3, 4, 4]
#A = spmatrix(V,I,J)
#B = matrix(1.0, (5,1))
#print(A)
#print(B)
#umfpack.linsolve(A,B)
#print(B)

#A = spmatrix(V,I,J)
#B = matrix(1.0, (5,1))
#klu.linsolve(A,B)
#print(B)

#from kvxopt import amd
#print(amd)
#A = spmatrix([10,3,5,-2,5,2], [0,2,1,2,2,3], [0,0,1,1,2,3])
#P = amd.order(A)
#print(P)


from andes.main import config_logger
#run('/cases/kundur_full.json', codegen=True)

from andes.system import System
#from andes.io import json as jsonio
from andes.io import parse
#from andes.routines.pflow import PFlow
#from andes.routines.tds import TDS

config_logger(file=False, stream_level=10)

system = System('/cases/kundur_full.json')
#jsonio.read(sys, '/cases/kundur_full.json')

system.prepare(quick=True, incremental=True)
#system.undill()

#from os import listdir
#print(listdir('/home/web_user/.andes'))

parse(system)
system.setup()
system.PFlow.run()
system.TDS.run()
              `));
    });
  });
</script>
</body>
</html>
